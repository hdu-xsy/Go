<div>
    <h2 id="Struts2">Struts2 框架</h2>
    <ul>
        <li>配置</li>
        <li>创建action</li>
        <li>方法访问</li>
        <li>全局结果页面配置</li>
        <li>获取表单</li>
        <li>操作域对象</li>
        <li>封装到实体类</li>
        <li>值栈</li>
        <li>拦截器</li>
    </ul>
    <blockquote>
        <p>表述层框架</p>
        <p>struts-2.5.14</p>
    </blockquote>
    <h4>配置 :</h4>
    <pre>
                配置过滤器
                &lt;filter&gt;
                    &lt;filter-name&gt;struts2&lt;/filter-name&gt;
                    &lt;filter-class&gt;org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;
                &lt;/filter&gt;
                &lt;filter-mapping&gt;
                    &lt;filter-name&gt;struts2&lt;/filter-name&gt;
                    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
                &lt;/filter-mapping&gt;
                struts.xml  
                &lt;!DOCTYPE struts PUBLIC
                        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
                        "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;
                 &lt;struts&gt;
                         &lt;package name="用于区分的名称" extends="struts-default" namespace="/"&gt;&lt;!-- namespace+actionname 构成访问路径 --&gt;
                                 &lt;action name="访问名称" class="类全路径" method="默认为execute方法"&gt;
                                         &lt;result name="返回值" type="默认为转发(dispatcher)chain/redirect/redirectAction"&gt;/返回页面&lt;/result&gt;
                                 &lt;/action&gt;
                         &lt;/package&gt;
                 &lt;/struts&gt;
                 编码: &lt;constant name="struts.i18n.encoding" value="UTF-8"&gt;&lt;/constant&gt;
                 分模块 &lt;include file="全路径"&gt;&lt;/include&gt;
                </pre>
    <h4>创建action:</h4>
    <ul>
        <li>1.
            <pre>
                public class 名称 {
                public String execute() {
                        return "返回值";
                    }
                }
                </pre>
        </li>
        <li>2
            <pre>
                import com.opensymphony.xwork2.Action;
                public class 名称 implements Action {  
                    @Override
                    public String execute() throws Exception {
                        // TODO Auto-generated method stub
                        return null;
                    }
                }
                </pre>
        </li>
        <li>3√
            <pre>
                import com.opensymphony.xwork2.ActionSupport;
                public class 名称 extends ActionSupport {  
                    @Override
                    public String execute() throws Exception {
                        // TODO Auto-generated method stub
                        return "";
                    }
                }  
                </pre>
        </li>
    </ul>
    <h4>方法访问:</h4>
    <pre>
                &lt;package name="名称" extends="struts-default" namespace="/"&gt;
                     &lt;action name="index_*" class="全路径" method="{1}"&gt;
                             &lt;result name="返回值"&gt;/网页&lt;/result&gt;
                     &lt;/action&gt;
                 &lt;/package&gt;
                </pre>
    <h4>全局结果页面配置:</h4> 
    <pre>
                &lt;package&gt;
                &lt;global-results&gt;&lt;result name="...."&gt;/....&lt;/result&gt;&lt;/global-results&gt;
                </pre>
    <h4>获取表单:</h4>  
    <pre>
                //耦合低
                ActionContext context = ActionContext.getContext();  
                Map&lt;String,Object&gt; map = context.getParameters();  
                Set&lt;String&gt; keys = map.keySet();
                for(String key:keys)
                {
                    Object[] obj = (Object[])map.get(key);
                    ...
                }  
                </pre>
    或 
    <pre>
                //常用
                HttpServletRequest request = ServletActionContext.getRequest();  
                String xxx = request.getParameter("xxx");  
                </pre>
    或 
    <pre>
                implements ServletRequestAware
                private HttpServletRequest request;
                public void setServletRequest(HttpServletRequest request) {
                    this.request = request;
                }
                </pre>
    <h4>操作域对象:</h4>  
    <pre>
                HttpServletRequest request = ServletActionContext.getRequest();
                request.setAttribute("名","值");
                HttpSession session = request.getSession();
                session.setAttribute("名","值");
                ServletContext context = ServletActionContext.getServletContext();
                context.setAttribute("名","值");
                </pre>
    <h4>封装到实体类:</h4>  
    <pre>
                public class index_action extends ActionSupport {  
                    定义变量;
                    get()....set()....;
                    @Override  
                    public String execute() throws Exception {
                        // TODO Auto-generated method stub
                        return "";
                    }
                }  
                </pre>
    或  √
    <pre>
                public class index_action extends ActionSupport implements ModelDriven&lt;Entity&gt; {  
                    private Entity Entity_name = new Entity();
                    public Entity getModel(){
                        return Entity;
                    }
                    @Override  
                    public String execute() throws Exception {
                        // TODO Auto-generated method stub
                        return "";
                    }
                }  
                </pre>
    或 
    <pre>
                &lt;input name="Entity_name.name"&gt;
                private Entity Entity_name;
                get()...set()...
                </pre>
    <h4>值栈:</h4>
    <ul>
        <li>ognl:
            <pre>
                &lt;% taglib uri="/struts-tags" prefix="s"%&gt;  
                &lt;s:property value="OGNL"&gt;  
                </pre>
        </li>
        <li>获取值栈对象
            <pre>
                ActionContext context = ActionContext.getContext();
                ValueStack stack = context.getValueStack();  
                </pre>
        </li>
        <li>值栈内放数据
            <pre>
                //stack.set("key","value");  
                或 
                //stack.push("value");  取 &lt;s:property value="[...].top"&gt;
                或 
                private String name;
                get()....;
                name="value";  
                </pre>
        </li>
        <li>值栈放对象:
            <pre>
                private Entity Entity_name = new Entity();
                public Entity getEntity(){
                    return Entity_name;
                    }
                Entity_name.set().....;  
                </pre>
        </li>
        <li>值栈放List:
            <pre>
                private List&lt;Entity&gt; list = new ArrayList&lt;Entity&gt;();
                public List&lt;Entity&gt; getList(){
                    return list;
                }  
                </pre>
        </li>
        <li>值栈取数据:
            <pre>
                &lt;s:property value="key"/&gt;  
                </pre>
        </li>
        <li>值栈取对象:
            <pre>
                &lt;s:property value="对象.属性"/&gt;  
                </pre>
        </li>
        <li>值栈取List:
            <pre>
                &lt;s:property value="List[...].属性"/&gt; 或 &lt;s:iterator value="list"&gt;&lt;s:property value="属性"/&gt;&lt;/s:iterator&gt;  
                或 &lt;s:iterator value="list" var="name"&gt;&lt;s:property value="#name.属性"/&gt;&lt;s:iterator&gt;
                </pre>
        </li>
    </ul>
    <h4>拦截器:</h4>  
    <pre>
                extends AbstractInterceptor
                //implements Interceptor
                void init()
                void destory()
                String intercept(ActionInvocation invocation)  
                或 
                extends MethodFilterInterceptor  
                重写doIntercept(ActionInvocation invocation)方法  
                配置拦截器:
                &lt;package内&gt;
                &lt;interceptors&gt;&lt;interceptor name="名称" class="全路径"&gt;&lt;/interceptor&gt;&lt;/interceptors&gt;  
                &lt;action内&gt;
                &lt;interceptor-ref name="名称"&gt;&lt;param name="excludeMethods"&gt;方法名&lt;/param&gt;&lt;/interceptor-ref&gt;  
                &lt;interceptor-ref name="defaultStack"&gt;&lt;/interceptor-ref&gt;
                登录拦截器:  
                public class 名称 extends MethodFilterInterceptor{
                    @Override
                    protected String doIntercept(ActionInvocation arg0) throws Exception {
                        // TODO Auto-generated method stub
                        HttpServletRequest request = ServletActionContext.getRequest();
                        Object obj = request.getSession().getAttribute("session名称");  
                        if(obj != null){
                            return arg0.invoke();
                        }else{
                            return "登录页面标签";
                        }
                    }
                }
                </pre>
</div>
<div><%+ "jstl.html" %></div>